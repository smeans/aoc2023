<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Advent of Code 2023 Day 1 Part 2</title>
    <script>
        document.addEventListener('submit', (e) => {
        const f = document.forms.main;
        e.preventDefault();
        
        f.output.value = sumLines(f.numbers.value);
        
        return false;
        });

        const digitre = /(one|two|three|four|five|six|seven|eight|nine|\d)/;
        const rdigitre = /(eno|owt|eerht|ruof|evif|xis|neves|thgie|enin|\d)/;
        const digitval = {
        'one': 1,
        'two': 2,
        'three': 3,
        'four': 4,
        'five': 5,
        'six': 6,
        'seven': 7,
        'eight': 8,
        'nine': 9,
        'eno': 1,
        'owt': 2,
        'eerht': 3,
        'ruof': 4,
        'evif': 5,
        'xis': 6,
        'neves': 7,
        'thgie': 8,
        'enin': 9,  
        1: 1,
        2: 2,
        3: 3,
        4: 4,
        5: 5,
        6: 6,
        7: 7,
        8: 8,
        9: 9
        };

        function rstr(s) {
        return s.split('').reverse().join('');
        }

        function sumLines(t) {
        const lines = t.split(/\n/);
        
        return lines.reduce((a, line) => {
            const firstdigit = line.match(digitre)[0];
            const lastdigit = rstr(line).match(rdigitre)[0];
            
            const v = digitval[firstdigit] * 10 + digitval[lastdigit];
            
            return a + v;
        }, 0);
        }
    </script>
  </head>
  <body>
    <form name="main">
        <p>
          <label>input</label>
          <textarea name="numbers">two1nine
      eightwothree
      abcone2threexyz
      xtwone3four
      4nineeightseven2
      zoneight234
      7pqrstsixteen</textarea>
        </p>
        <p><input type="submit" value="sum!"/></p>
        <p><label>result: </label><output name="output"></output></p>
      </form>
</html>